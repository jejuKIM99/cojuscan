<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' https://cdn.tailwindcss.com; style-src 'self' 'unsafe-inline'; img-src 'self' data:;">
    <title>cojuscan</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style id="dynamic-theme-styles">
        /* 테마 CSS 변수는 renderer.js에 의해 동적으로 여기에 삽입됩니다. */
    </style>
    <style>
        /* 기본 구조 및 비색상 스타일 */
        html, body { height: 100%; overflow: hidden; }
        body { font-family: 'Inter', sans-serif; background-color: var(--main-bg); color: var(--text-color); -ms-overflow-style: none; scrollbar-width: none; }
        body::-webkit-scrollbar { display: none; }
        #title-bar { -webkit-app-region: drag; }
        #title-bar-btns { -webkit-app-region: no-drag; }
        .file-tree ul { padding-left: 1rem; }
        .file-tree .folder-label { cursor: pointer; }
        .file-tree .folder-icon::before { content: '📁'; margin-right: 0.5rem; color: var(--accent-color); }
        .file-tree .file-icon { display: inline-flex; align-items: center; justify-content: center; width: 1rem; height: 1rem; margin-right: 0.5rem; color: var(--text-color-dark); flex-shrink: 0; }
        .file-tree .toggler::before { content: '▶'; display: inline-block; margin-right: 0.5rem; transition: transform 0.1s ease-in-out; color: var(--accent-color); }
        .file-tree .toggler.open::before { transform: rotate(90deg); }
        .form-checkbox:checked { background-color: var(--accent-color); }
        #results-container, #file-tree-container, #help-modal-content, #vulnerabilities-list, #theme-editor-properties { scrollbar-width: thin; scrollbar-color: var(--scrollbar-thumb-color) var(--scrollbar-track-color); }
        #results-container::-webkit-scrollbar, #file-tree-container::-webkit-scrollbar, #help-modal-content::-webkit-scrollbar, #vulnerabilities-list::-webkit-scrollbar, #theme-editor-properties::-webkit-scrollbar { width: 8px; }
        #results-container::-webkit-scrollbar-track, #file-tree-container::-webkit-scrollbar-track, #help-modal-content::-webkit-scrollbar-track, #vulnerabilities-list::-webkit-scrollbar-track, #theme-editor-properties::-webkit-scrollbar-track { background: var(--scrollbar-track-color); }
        #results-container::-webkit-scrollbar-thumb, #file-tree-container::-webkit-scrollbar-thumb, #help-modal-content::-webkit-scrollbar-thumb, #vulnerabilities-list::-webkit-scrollbar-thumb, #theme-editor-properties::-webkit-scrollbar-thumb { background-color: var(--scrollbar-thumb-color); border-radius: 4px; border: 2px solid var(--scrollbar-track-color); }
        .ext-shield { display: inline-block; border-radius: 4px; padding: 2px 8px; font-size: 12px; font-family: 'Verdana', sans-serif; color: white; height: 20px; line-height: 16px; }

        /* 테마 편집 모드에서 메인 컨텐츠 비활성화 (블러 제거) */
        body.theme-editing-active .main-content {
            pointer-events: none;
        }
        /* 상태 미리보기 스타일 */
        .preview-hover-primary { background-color: var(--button-primary-hover-bg) !important; }
        .preview-hover-secondary { background-color: var(--button-secondary-hover-bg) !important; }
        .preview-hover-danger { background-color: var(--button-danger-hover-bg) !important; }
        .preview-hover-simple { background-color: var(--button-scan-simple-hover-bg) !important; }
        .preview-hover-precision { background-color: var(--button-scan-precision-hover-bg) !important; }
        
        #start-scan-simple-btn.preview-active { background-color: var(--button-scan-simple-bg) !important; color: var(--button-scan-text) !important; }
        #start-scan-precision-btn.preview-active { background-color: var(--button-scan-precision-bg) !important; color: var(--button-scan-text) !important; }


        /* 토글 스위치 스타일 */
        .toggle-switch { position: relative; display: inline-block; width: 34px; height: 20px; }
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .toggle-slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background-color: #4b5563; transition: .4s; border-radius: 20px; }
        .toggle-slider:before { position: absolute; content: ""; height: 14px; width: 14px; left: 3px; bottom: 3px; background-color: white; transition: .4s; border-radius: 50%; }
        input:checked + .toggle-slider { background-color: #00FF41; }
        input:checked + .toggle-slider:before { transform: translateX(14px); }
    </style>
</head>
<body class="select-none">
    <div id="title-bar" class="h-8 bg-black flex justify-between items-center fixed top-0 left-0 right-0 z-50">
        <div class="flex items-center pl-3">
            <div class="text-sm font-bold">cojuscan</div>
            <span id="app-version" class="ml-2 text-xs font-mono text-gray-400"></span>
        </div>
        <div id="title-bar-btns" class="flex items-center h-full">
            <div class="relative">
                <button id="theme-btn" class="px-3 h-full hover:bg-gray-700 transition-colors flex items-center" title="Change Theme">
                    <img src="./build/theme.svg" alt="Theme Icon" class="w-4 h-4">
                    </button>
                <div id="theme-dropdown" class="hidden absolute right-0 mt-2 w-48 bg-[var(--secondary-bg)] border border-[var(--border-color)] rounded-md shadow-lg z-20">
                    </div>
            </div>
            <div class="relative">
                <button id="lang-btn" class="px-3 h-full hover:bg-gray-700 transition-colors flex items-center" title="Change Language">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-gray-300"><circle cx="12" cy="12" r="10"></circle><line x1="2" y1="12" x2="22" y2="12"></line><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path></svg>
                </button>
                <div id="lang-dropdown" class="hidden absolute right-0 mt-2 w-28 bg-[var(--secondary-bg)] border border-[var(--border-color)] rounded-md shadow-lg">
                    </div>
            </div>
            <button id="minimize-btn" class="px-3 h-full hover:bg-gray-700 transition-colors"><svg width="12" height="12" viewBox="0 0 12 12"><rect fill="#E0E0E0" width="10" height="1" x="1" y="6"></rect></svg></button>
            <button id="maximize-btn" class="px-3 h-full hover:bg-gray-700 transition-colors">
                <svg id="maximize-icon" width="12" height="12" viewBox="0 0 12 12"><rect width="9" height="9" x="1.5" y="1.5" fill="none" stroke="#E0E0E0" stroke-width="1"></rect></svg>
                <svg id="unmaximize-icon" width="12" height="12" viewBox="0 0 12 12" class="hidden"><path fill="none" stroke="#E0E0E0" stroke-width="1" d="M3.5,3.5 L3.5,8.5 L8.5,8.5 M3.5,3.5 L8.5,3.5 M2.5,2.5 L2.5,7.5 L7.5,7.5"></path></svg>
            </button>
            <button id="close-btn" class="px-3 h-full hover:bg-red-500 transition-colors"><svg width="12" height="12" viewBox="0 0 12 12"><polygon fill="#E0E0E0" points="11 1.576 10.424 1 6 5.424 1.576 1 1 1.576 5.424 6 1 10.424 1.576 11 6 6.576 10.424 11 11 10.424 6.576 6"></polygon></svg></button>
        </div>
    </div>

    <div class="main-content flex h-screen pt-8">
        <aside class="w-1/3 bg-[var(--secondary-bg)] p-4 flex flex-col border-r border-[var(--border-color)]">
            <div class="flex justify-between items-center mb-4">
                <h1 class="text-xl font-bold text-[var(--accent-color)]" data-i18n="codeExplorer">Code Explorer</h1>
                <button id="help-btn" class="text-2xl font-bold text-[var(--text-color-dark)] hover:text-white">?</button>
            </div>
            <button id="select-dir-btn" class="w-full bg-[var(--button-primary-bg)] hover:bg-[var(--button-primary-hover-bg)] text-[var(--button-primary-text)] font-bold py-2 px-4 rounded-lg transition duration-200 mb-4 border border-green-600" data-i18n="selectDirectory">디렉토리 선택</button>
            <div class="mb-2">
                <input type="text" id="search-input" class="w-full p-2 bg-[var(--input-bg)] border border-[var(--border-color)] rounded-md focus:outline-none focus:ring-2 focus:ring-[var(--accent-color)]" data-i18n-placeholder="searchFilesPlaceholder">
            </div>
            <div class="flex space-x-2 mb-2">
                <button id="select-all-btn" class="flex-1 bg-[var(--button-secondary-bg)] hover:bg-[var(--button-secondary-hover-bg)] text-sm py-1 px-2 rounded-md" data-i18n="selectAll">전체 선택</button>
                <button id="deselect-all-btn" class="flex-1 bg-[var(--button-secondary-bg)] hover:bg-[var(--button-secondary-hover-bg)] text-sm py-1 px-2 rounded-md" data-i18n="deselectAll">전체 해제</button>
            </div>
            <div id="file-tree-container" class="flex-grow overflow-y-auto bg-[var(--main-bg)] rounded-lg p-2 file-tree">
                <p class="text-[var(--text-color-dark)] text-center py-10" data-i18n="selectProjectFolder">프로젝트 폴더를 선택하세요.</p>
            </div>
        </aside>

        <main class="w-2/3 p-6 flex flex-col">
            <header class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold text-[var(--accent-color)]" data-i18n="vulnerabilityScan">Vulnerability Scan</h2>
                <div class="flex space-x-2">
                    <button id="start-scan-simple-btn" class="bg-[var(--button-scan-simple-bg)] hover:bg-[var(--button-scan-simple-hover-bg)] text-[var(--button-scan-text)] font-bold py-2 px-4 rounded-lg transition duration-200 disabled:bg-[var(--button-disabled-bg)] disabled:text-[var(--button-disabled-text)] disabled:cursor-not-allowed" disabled data-i18n="startSimpleScan">단순 검사</button>
                    <button id="start-scan-precision-btn" class="bg-[var(--button-scan-precision-bg)] hover:bg-[var(--button-scan-precision-hover-bg)] text-[var(--button-scan-text)] font-bold py-2 px-4 rounded-lg transition duration-200 disabled:bg-[var(--button-disabled-bg)] disabled:text-[var(--button-disabled-text)] disabled:cursor-not-allowed" disabled data-i18n="startPrecisionScan">정밀 검사</button>
                </div>
            </header>
            <div class="flex justify-between items-center mb-6">
                <div class="flex-grow mr-4"> 
                    <h3 class="text-lg font-semibold mb-2" data-i18n="progress">Progress</h3>
                    <div class="w-full bg-gray-700 rounded-full h-2"><div id="progress-bar" class="bg-[var(--progress-bar-bg)] h-2 rounded-full transition-all duration-300" style="width: 0%"></div></div>
                    <p id="progress-text" class="text-left text-[var(--text-color-dark)] text-sm mt-1">0%</p>
                </div>
                <button id="export-pdf-btn" class="bg-[var(--button-danger-bg)] hover:bg-[var(--button-danger-hover-bg)] text-white font-bold py-2 px-4 rounded-lg transition duration-200 hidden flex-shrink-0" data-i18n="exportReport">보고서 출력</button>
            </div>
            <div id="results-container" class="flex-grow bg-[var(--secondary-bg)] rounded-lg p-4 overflow-y-auto border border-[var(--border-color)]">
                <p class="text-[var(--text-color-dark)] text-center py-10" data-i18n="startScanToSeeResults">검사를 시작하여 취약점 결과를 확인하세요.</p>
            </div>
        </main>
    </div>
    
    <div id="help-modal" class="hidden fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50">
        <div class="bg-[var(--secondary-bg)] rounded-lg shadow-lg p-6 w-3/4 max-w-5xl h-3/4 flex flex-col border-2 border-[var(--accent-color)]">
            <div class="flex justify-between items-center mb-4">
                <h2 class="text-2xl font-bold text-[var(--accent-color)]" data-i18n="helpTitle">도움말</h2>
                <button id="close-modal-btn" class="text-2xl text-[var(--text-color-dark)] hover:text-white">&times;</button>
            </div>
            <div id="help-modal-content" class="flex-grow overflow-y-auto pr-2 text-sm">
                <div class="mb-6">
                    <h3 class="text-xl font-semibold mb-3 border-b-2 border-[var(--accent-color)] pb-2" data-i18n="detectableVulnerabilities">탐지 가능 취약점</h3>
                    <div class="grid grid-cols-2 gap-6 h-[250px]">
                        <div id="vulnerabilities-list" class="overflow-y-auto pr-2"></div>
                        <div id="vuln-details-panel" class="bg-black p-4 rounded-md text-[var(--text-color)]">
                            <p class="text-[var(--text-color-dark)]" data-i18n="clickVulnerabilityToSeeDetails">왼쪽 목록에서 취약점 항목을 클릭하여 설명을 확인하세요.</p>
                        </div>
                    </div>
                </div>
                <div>
                    <h3 class="text-xl font-semibold mb-3 border-b-2 border-[var(--accent-color)] pb-2" data-i18n="supportedExtensions">지원 확장자</h3>
                    <div id="extensions-list" class="flex flex-wrap gap-2"></div>
                </div>
            </div>
        </div>
    </div>

    <div id="theme-editor-panel" class="hidden fixed bottom-0 left-0 right-0 bg-[#1A1A1A] border-t border-[#2a2a2a] shadow-2xl z-50 flex flex-col transition-all">
        <div class="flex items-center p-3 space-x-4 border-b border-[#2a2a2a]">
            <h3 class="text-lg font-bold text-[#00FF41]" data-i18n="themeEditorTitle">테마 편집기</h3>
            <input type="text" id="custom-theme-name" data-i18n-placeholder="themeNamePlaceholder" class="w-48 p-2 bg-[#1f2937] border border-[#2a2a2a] rounded-md focus:outline-none focus:ring-2 focus:ring-[#00FF41] text-sm text-[#E0E0E0]">
            <button id="save-theme-btn" class="bg-[#16a34a] hover:bg-[#22c55e] text-white font-bold py-2 px-3 rounded-lg text-sm" data-i18n="addTheme">추가</button>
            <div class="flex items-center space-x-4">
                <label class="flex items-center space-x-2 text-sm text-[#E0E0E0] cursor-pointer">
                    <span data-i18n="hoverPreview">호버 미리보기</span>
                    <label class="toggle-switch"><input type="checkbox" id="hover-preview-toggle"><span class="toggle-slider"></span></label>
                </label>
                <label class="flex items-center space-x-2 text-sm text-[#E0E0E0] cursor-pointer">
                    <span data-i18n="activePreview">활성화 미리보기</span>
                    <label class="toggle-switch"><input type="checkbox" id="active-preview-toggle"><span class="toggle-slider"></span></label>
                </label>
            </div>
            <div class="flex-grow"></div>
            <button id="close-theme-editor-btn" class="bg-[#dc2626] hover:bg-[#ef4444] text-white font-bold py-2 px-3 rounded-lg text-sm" data-i18n="close">닫기</button>
            <p id="theme-editor-message" class="text-yellow-400 text-xs h-4 absolute right-24"></p>
        </div>
        <div id="theme-editor-properties" class="p-3 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-x-4 gap-y-2 overflow-y-auto" style="max-height: 180px;">
            </div>
    </div>

    <script src="./renderer.js"></script>
</body>
</html>